<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Editor Login ‚Äî Camila Tiburcio Rubio</title>

  <!-- Fonts + Tailwind -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Source+Serif+4:opsz,wght@8..60,400..800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter','system-ui','sans-serif'],
            serif: ['Source Serif 4','Georgia','serif'],
          },
          colors: {
            ink: { 900:'#0E0E0E',700:'#1F1F1F',500:'#3A3A3A',300:'#9CA3AF' },
            cream: '#FAF7F2',
            accent: { DEFAULT:'#C53D2F', dark:'#9E2F24', light:'#E95A49' },
          },
          boxShadow: {
            soft: '0 10px 30px rgba(0,0,0,0.06)',
            glow: '0 18px 45px rgba(0,0,0,0.08)',
          }
        }
      }
    }
  </script>
  <style>
    body { -webkit-font-smoothing: antialiased; }
    .u-underline {
      position: relative;
    }
    .u-underline::after {
      content:'';
      position:absolute;
      left:0;
      bottom:-2px;
      width:100%;
      height:2px;
      background:currentColor;
      transform:scaleX(0);
      transform-origin:left;
      transition:transform .22s ease;
    }
    .u-underline:hover::after {
      transform:scaleX(1);
    }
    .login-card {
      backdrop-filter: blur(14px);
      background: rgba(255,255,255,0.88);
    }
    .shake {
      animation: shake 0.18s linear 0s 2;
    }
    @keyframes shake {
      0%   { transform: translateX(0); }
      25%  { transform: translateX(-3px); }
      50%  { transform: translateX(3px); }
      75%  { transform: translateX(-2px); }
      100% { transform: translateX(0); }
    }
  </style>
</head>
<body class="min-h-screen bg-cream text-ink-900 flex flex-col">

  <!-- Header / back link -->
  <header class="border-b border-black/5 bg-cream/80 backdrop-blur sticky top-0 z-20">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
      <div class="flex items-center gap-2">
        <a href="index.html" class="flex items-center gap-2" aria-label="Home">
          <img src="assets/logo.png" alt="Camila Tiburcio Rubio logo" class="h-10 w-10 object-contain" />
          <span class="font-serif text-xl sm:text-2xl tracking-tight">Camila Tiburcio Rubio</span>
        </a>
      </div>
      <a href="index.html" class="u-underline text-xs sm:text-sm text-ink-500" title="Back to site">
        ‚Üê Back to site
      </a>
    </div>
  </header>

  <!-- Main -->
  <main class="flex-1 flex items-center justify-center px-4 py-10">
    <div class="max-w-5xl w-full grid md:grid-cols-2 gap-10 md:gap-14 items-center">

      <!-- Left: copy / mood -->
      <section class="space-y-4 md:space-y-6">
        <p class="text-[11px] uppercase tracking-[0.22em] text-accent font-semibold">
          Editor‚Äôs Room
        </p>
        <h1 class="font-serif text-3xl sm:text-4xl leading-snug">
          Private entry for drafts, edits, and new work.
        </h1>
        <p class="text-sm sm:text-base text-ink-500 max-w-md">
          This space is just for Camila. Use your passphrase to step into the
          back-end of the site where you can publish pieces, save drafts, and
          revise works that are already live.
        </p>

        <div class="hidden md:flex items-center gap-3 text-xs text-ink-400">
          <div class="h-[1px] bg-black/10 flex-1"></div>
          <span class="uppercase tracking-[0.16em]">For editor use only</span>
          <div class="h-[1px] bg-black/10 flex-1"></div>
        </div>

        <div class="mt-4 hidden sm:flex items-center gap-3 text-xs text-ink-400">
          <div class="flex -space-x-2">
            <div class="w-8 h-8 rounded-full overflow-hidden border border-white shadow-soft">
              <img src="assets/camila.jpg" alt="Camila" class="w-full h-full object-cover">
            </div>
          </div>
          <p>
            Changes here update the live site once you publish from the
            <span class="font-semibold text-ink-500">Admin editor</span>.
          </p>
        </div>
      </section>

      <!-- Right: login card -->
      <section
        id="loginCard"
        class="login-card shadow-glow border border-black/5 rounded-2xl p-6 sm:p-7 md:p-8 relative overflow-hidden"
      >
        <!-- Soft accent ribbon -->
        <div class="pointer-events-none absolute -right-10 -top-10 w-40 h-40 rounded-full bg-accent/5 blur-3xl"></div>

        <div class="relative space-y-5">
          <div>
            <p class="text-[11px] uppercase tracking-[0.20em] text-ink-300 font-semibold mb-1">
              Sign in
            </p>
            <h2 class="font-serif text-2xl">
              Enter the editor‚Äôs passphrase
            </h2>
            <p class="text-sm text-ink-400 mt-1.5">
              One shared passphrase, no usernames. Keep it offline and just for us.
            </p>
          </div>

          <form id="loginForm" class="space-y-5" autocomplete="off">
            <div>
              <label for="passphrase" class="block text-xs font-medium text-ink-500 uppercase tracking-[0.16em] mb-1.5">
                Passphrase
              </label>
              <div class="relative">
                <input
                  id="passphrase"
                  name="passphrase"
                  type="password"
                  inputmode="text"
                  class="w-full rounded-xl border border-black/10 bg-white/80 px-3.5 py-2.5 pr-10 text-sm outline-none shadow-soft focus:ring-2 focus:ring-accent/30 focus:border-accent/60"
                  placeholder="Enter editor passphrase"
                  required
                />
                <button
                  type="button"
                  id="toggleVisibility"
                  class="absolute inset-y-0 right-2 flex items-center px-2 text-xs text-ink-300 hover:text-ink-500"
                  tabindex="-1"
                  aria-label="Show or hide passphrase"
                >
                  üëÅ
                </button>
              </div>
            </div>

            <div class="flex items-center justify-between gap-3 text-xs text-ink-400">
              <div class="flex items-center gap-2">
                <span class="inline-flex h-2 w-2 rounded-full bg-accent"></span>
                <span>Protected with a hashed secret in the browser.</span>
              </div>
              <span class="hidden sm:inline text-[11px] italic text-ink-300">
                Hint: keep your phrase in a notebook, not online.
              </span>
            </div>

            <button
              id="submitBtn"
              type="submit"
              class="w-full inline-flex items-center justify-center gap-2 rounded-xl bg-accent text-white text-sm font-semibold px-4 py-2.5 shadow-soft hover:bg-accent-dark active:scale-[0.99] transition"
            >
              <span>Enter editor space</span>
              <span aria-hidden="true">‚Ü≥</span>
            </button>

            <p id="errorMsg" class="text-xs text-accent mt-1 h-4"></p>
            <p id="statusMsg" class="text-xs text-ink-300 mt-1 h-4"></p>
          </form>
        </div>
      </section>
    </div>
  </main>

  <!-- Tiny footer -->
  <footer class="border-t border-black/5 py-4">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 flex items-center justify-between text-[11px] text-ink-300">
      <span>¬© <span id="year"></span> Camila Tiburcio Rubio.</span>
      <span class="hidden sm:inline">This login exists only on this device and browser.</span>
    </div>
  </footer>

  <script>
    // Set year
    document.getElementById('year').textContent = new Date().getFullYear();

    // ===== Hashed secret (replace this with your real hash) =====
    // Use the same value you already generated earlier.
    const HASHED_SECRET = "e3373a2262f1092c7358d2fc18dc75493369ec1280e9f7e18e12537b06d985a9";

    // Utility: convert string -> ArrayBuffer
    function textToArrayBuffer(str) {
      return new TextEncoder().encode(str);
    }

    // Utility: convert ArrayBuffer -> hex
    function bufferToHex(buffer) {
      const bytes = new Uint8Array(buffer);
      let hex = "";
      for (let i = 0; i < bytes.length; i++) {
        const h = bytes[i].toString(16).padStart(2, "0");
        hex += h;
      }
      return hex;
    }

    async function sha256(str) {
      const data = textToArrayBuffer(str);
      const hashBuffer = await crypto.subtle.digest("SHA-256", data);
      return bufferToHex(hashBuffer);
    }

    // ===== UI elements =====
    const form          = document.getElementById("loginForm");
    const passInput     = document.getElementById("passphrase");
    const errorMsg      = document.getElementById("errorMsg");
    const statusMsg     = document.getElementById("statusMsg");
    const submitBtn     = document.getElementById("submitBtn");
    const loginCard     = document.getElementById("loginCard");
    const toggleVisBtn  = document.getElementById("toggleVisibility");

    // Show / hide passphrase
    toggleVisBtn?.addEventListener("click", () => {
      if (!passInput) return;
      const isPwd = passInput.type === "password";
      passInput.type = isPwd ? "text" : "password";
      toggleVisBtn.textContent = isPwd ? "üôà" : "üëÅ";
    });

    function setLoading(isLoading) {
      if (!submitBtn) return;
      submitBtn.disabled = isLoading;
      submitBtn.style.opacity = isLoading ? "0.8" : "1";
      submitBtn.style.cursor  = isLoading ? "wait" : "pointer";
      submitBtn.firstElementChild.textContent = isLoading
        ? "Checking passphrase‚Ä¶"
        : "Enter editor space";
    }

    form?.addEventListener("submit", async (e) => {
      e.preventDefault();
      errorMsg.textContent = "";
      statusMsg.textContent = "";

      const value = passInput.value.trim();
      if (!value) {
        errorMsg.textContent = "Passphrase can‚Äôt be empty.";
        loginCard.classList.add("shake");
        setTimeout(() => loginCard.classList.remove("shake"), 200);
        return;
      }

      try {
        setLoading(true);
        statusMsg.textContent = "Verifying‚Ä¶";
        const hash = await sha256(value);

        if (hash === HASHED_SECRET) {
          // success ‚Üí set localStorage flag and redirect
          localStorage.setItem("ctr:admin:auth", "ok");
          statusMsg.textContent = "Welcome back, Camila. Redirecting‚Ä¶";
          errorMsg.textContent = "";
          setTimeout(() => {
            window.location.href = "admin.html";
          }, 400);
        } else {
          errorMsg.textContent = "Incorrect passphrase. Try again.";
          statusMsg.textContent = "";
          passInput.value = "";
          passInput.focus();
          loginCard.classList.add("shake");
          setTimeout(() => loginCard.classList.remove("shake"), 200);
        }
      } catch (err) {
        console.error(err);
        errorMsg.textContent = "Something went wrong verifying your passphrase.";
        statusMsg.textContent = "";
        loginCard.classList.add("shake");
        setTimeout(() => loginCard.classList.remove("shake"), 200);
      } finally {
        setLoading(false);
      }
    });
  </script>
</body>
</html>
