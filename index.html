<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Camila Tiburcio Rubio — Essays, Interviews, Visual Work</title>

  <!-- SEO -->
  <meta name="description" content="Essays, interviews, and visual work by Camila Tiburcio Rubio." />
  <link rel="canonical" href="https://example.com/" />
  <meta name="robots" content="index,follow" />

  <!-- Open Graph -->
  <meta property="og:title" content="Camila Tiburcio Rubio" />
  <meta property="og:description" content="Essays, interviews, and visual work by Camila Tiburcio Rubio." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://example.com/" />
  <meta property="og:image" content="https://example.com/assets/og-image.jpg" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Camila Tiburcio Rubio" />
  <meta name="twitter:description" content="Essays, interviews, and visual work by Camila Tiburcio Rubio." />
  <meta name="twitter:image" content="https://example.com/assets/og-image.jpg" />

  <!-- Favicon -->
  <link rel="icon" href="assets/favicon.svg" type="image/svg+xml" />
  <link rel="alternate icon" href="assets/favicon.png" />

  <!-- Fonts & Tailwind -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Source+Serif+4:opsz,wght@8..60,400..800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
            serif: ['Source Serif 4', 'Georgia', 'serif']
          },
          colors: {
            ink: { 900: '#0E0E0E', 700: '#1F1F1F', 500: '#3A3A3A', 300: '#9CA3AF' },
            cream: '#FAF7F2',
            accent: { DEFAULT: '#C53D2F', dark: '#9E2F24', light: '#E95A49' }
          },
          boxShadow: { soft: '0 10px 30px rgba(0,0,0,0.06)' }
        }
      }
    }
  </script>
  <style>
    .u-underline { position: relative; }
    .u-underline::after {
      content: ''; position: absolute; left: 0; bottom: -2px; height: 2px; width: 100%;
      background: currentColor; transform: scaleX(0); transform-origin: left; transition: transform .25s ease;
    }
    .u-underline:hover::after { transform: scaleX(1); }
    ::selection { background: rgba(197,61,47,0.15); }

    /* Hover cue for any clickable card/list-row we marked with data-href */
    [data-href]{
      transition: box-shadow .2s ease, transform .2s ease, background-color .2s ease;
    }

    /* Soft lift + stronger shadow on hover (matches “Sections” vibe) */
    [data-href]:hover{
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(0,0,0,.12), 0 2px 8px rgba(0,0,0,.06);
    }

    /* Keyboard focus looks the same and is accessible */
    [data-href]:focus-visible{
      outline: 2px solid #C53D2F;      /* your accent */
      outline-offset: 2px;
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(0,0,0,.12), 0 2px 8px rgba(0,0,0,.06);
    }

    /* Make li relative so the pseudo background can sit behind it */
    #picks li[data-href] {
      position: relative;
    }

    /* Invisible white background plate in default state */
    #picks li[data-href]::before {
      content: "";
      position: absolute;
      inset: 0;
      background: white;
      border-radius: 1rem;
      box-shadow: 0 5px 12px rgba(0,0,0,0.06);
      
      opacity: 0;                /* <-- hidden by default */
      transform: scale(0.97);    /* <-- slightly smaller by default */

      transition: 
        opacity .25s ease,
        transform .25s ease,
        box-shadow .25s ease;

      z-index: -1;               /* stay behind image + text */
    }

    /* Hover: the white plate fades in + expands slightly */
    #picks li[data-href]:hover::before {
      opacity: 1;
      transform: scale(1.05);
      box-shadow: 0 10px 30px rgba(0,0,0,.12), 0 3px 10px rgba(0,0,0,.08);
    }

    input[type="search"]::-webkit-search-cancel-button,
    input[type="search"]::-webkit-search-decoration,
    input[type="search"]::-webkit-search-results-button,
    input[type="search"]::-webkit-search-results-decoration {
      -webkit-appearance: none;
      appearance: none;
      display: none;
    }

  </style>
</head>
<body class="bg-cream text-ink-900 antialiased">
  <!-- Top announcement bar -->
  <div class="bg-ink-900 text-white text-sm">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-2 flex items-center justify-between">
      <p>New: Fall features now live — interviews, essays & visual art</p>
      <a href="#newsletter" class="u-underline">Subscribe</a>
    </div>
  </div>

  <!-- Header -->
  <header class="sticky top-0 z-50 backdrop-blur supports-[backdrop-filter]:bg-cream/80 bg-cream/95 border-b border-black/5">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-20">
        <div class="flex items-center gap-2">
          <a href="index.html" class="flex items-center gap-2" aria-label="Home">
            <img src="assets/logo.png" alt="Camila Tiburcio Rubio logo" class="h-12 w-12 object-contain" />
            <span class="font-serif text-2xl tracking-tight">Camila Tiburcio Rubio</span>
          </a>
        </div>

        <!-- Desktop nav -->
        <nav class="hidden md:flex items-center gap-8" aria-label="Primary">
          <a class="u-underline" href="features.html">Features</a>
          <a class="u-underline" href="latest.html">Latest</a>
          <a class="u-underline" href="sections.html">Sections</a>
          <a class="u-underline" href="about2.html">About</a>
        </nav>

        <!-- Desktop search -->
        <div class="hidden md:flex items-center gap-4">
          <label class="relative" aria-label="Search site">
            <input id="qHeader" type="search" placeholder="Search…" class="pl-10 pr-10 py-2 rounded-full border border-black/10 bg-white/70 focus:bg-white outline-none focus:ring-2 focus:ring-accent/40" />
            <svg class="w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-ink-300" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2" fill="none"/><path d="M21 21l-3.5-3.5" stroke="currentColor" stroke-width="2" fill="none"/></svg>
            <button id="qHeaderBtn" class="absolute right-2 top-1/2 -translate-y-1/2 text-ink-300 hover:text-ink-500" aria-label="Search">↵</button>
          </label>
        </div>

        <!-- Mobile hamburger -->
        <div class="md:hidden">
          <button id="menuToggle" class="p-2 rounded-md border border-black/10 focus:outline-none" aria-expanded="false" aria-controls="mobileMenu" aria-label="Open menu">
            <svg id="menuIcon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Mobile dropdown menu -->
    <div id="mobileMenu" class="hidden md:hidden bg-cream border-t border-black/10">
      <nav class="px-4 py-4 space-y-3" aria-label="Mobile">
        <a class="block u-underline" href="features.html">Features</a>
        <a class="block u-underline" href="latest.html">Latest</a>
        <a class="block u-underline" href="sections.html">Sections</a>
        <a class="block u-underline" href="about2.html">About</a>
        <label class="relative block mt-3" aria-label="Search site">
          <input id="qHeaderMobile" type="search" placeholder="Search…" class="w-full pl-10 pr-10 py-2 rounded-full border border-black/10 bg-white/70 focus:bg-white outline-none focus:ring-2 focus:ring-accent/40" />
          <svg class="w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-ink-300" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2" fill="none"/><path d="M21 21l-3.5-3.5" stroke="currentColor" stroke-width="2" fill="none"/></svg>
          <button id="qHeaderMobileBtn" class="absolute right-2 top-1/2 -translate-y-1/2 text-ink-300 hover:text-ink-500" aria-label="Search">↵</button>
        </label>
      </nav>
    </div>
  </header>

  <!-- Hero / Featured -->
  <section id="home" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-10">
    <div class="grid lg:grid-cols-3 gap-8 items-stretch">
      <!-- Lead story (injected) -->
      <article id="lead" class="lg:col-span-2 bg-white shadow-soft rounded-2xl overflow-hidden">
        <div class="aspect-[16/9] bg-ink-900/5">
          <img id="leadImg" src="https://picsum.photos/1200/675" alt="Lead story image" class="w-full h-full object-cover"/>
        </div>
        <div class="p-6 sm:p-8">
          <div class="flex items-center gap-3 text-xs uppercase tracking-wide text-accent">
            <span id="leadBadge" class="bg-accent/10 text-accent px-2.5 py-1 rounded-full">Feature</span>
            <time id="leadDate" datetime="" class="text-ink-300"></time>
          </div>
          <h1 id="leadTitle" class="font-serif text-3xl sm:text-4xl mt-3 leading-tight">The Title of a Great Essay!</h1>
          <p id="leadExcerpt" class="text-ink-500 mt-3 max-w-2xl"></p>
          <div class="mt-6 flex items-center gap-4">
            <img id="leadAvatar" class="h-10 w-10 rounded-full object-cover" src="assets/camila.jpg" alt="Author avatar"/>
            <div>
              <p class="text-sm font-medium">By <a id="leadAuthor" class="u-underline" href="about2.html">Camila Tiburcio Rubio</a></p>
              <p id="leadRead" class="text-xs text-ink-300"></p>
            </div>
          </div>
        </div>
        <a id="leadLink" href="#" class="sr-only">Read</a>
      </article>

      <!-- Sidebar: Editors' Picks -->
      <aside class="space-y-5">
        <h2 class="font-serif text-xl">Editors’ Picks</h2>
        <ul id="picks" class="space-y-5">
          <!-- items injected -->
        </ul>
      </aside>
    </div>
  </section>

  <!-- Features grid (featured posts only) -->
  <section id="features" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-14">
    <div class="flex items-end justify-between mb-6">
      <h2 class="font-serif text-2xl">Featured Posts</h2>
      <a class="u-underline text-sm" href="features.html">View all</a>
    </div>
    <div id="featuresGrid" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-8">
      <!-- cards injected -->
    </div>
  </section>

  <!-- Latest + Sidebar -->
  <section id="latest" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-14">
    <div class="grid lg:grid-cols-3 gap-10">
      <!-- Latest posts list -->
      <div class="lg:col-span-2">
        <div class="flex items-end justify-between mb-6">
          <h2 class="font-serif text-2xl">Latest</h2>
          <a class="u-underline text-sm" href="latest.html">View all</a>
        </div>
        <div id="latestList" class="divide-y divide-black/10 bg-white rounded-2xl shadow-soft">
          <!-- rows injected -->
        </div>
      </div>

      <!-- Sidebar: About + Newsletter -->
      <aside>
        <div id="about" class="bg-white rounded-2xl shadow-soft p-6">
          <h3 class="font-serif text-xl">About</h3>
          <p class="text-ink-500 mt-2">A blog documenting and expanding upon Camila Tiburcio Rubio's research and educational pursuits, interests and experiences.</p>
          <a href="about2.html" class="mt-3 inline-block u-underline">Read more about the author</a>
        </div>
        <div id="newsletter" class="bg-white rounded-2xl shadow-soft p-6 mt-6">
          <h3 class="font-serif text-xl">Newsletter</h3>
          <p class="text-ink-500 mt-2">Get a monthly roundup of essays, interviews, and events.</p>
          <form class="mt-4 flex gap-2" method="post" action="/subscribe">
            <input type="email" name="email" placeholder="you@example.com" required class="flex-1 px-4 py-3 rounded-xl border border-black/10 focus:ring-2 focus:ring-accent/40 outline-none" />
            <button type="submit" class="px-5 py-3 rounded-xl bg-accent text-white hover:bg-accent-dark">Subscribe</button>
          </form>
          <p class="text-xs text-ink-300 mt-2">By subscribing you agree to our terms.</p>
        </div>
      </aside>
    </div>
  </section>

  <!-- Sections / Categories -->
  <section id="sections" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-16">
    <div class="flex items-end justify-between mb-6">
      <h2 class="font-serif text-2xl">Sections</h2>
      <!-- NEW: View all for Sections -->
      <a class="u-underline text-sm" href="sections.html">View all</a>
    </div>
    <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-6">
      <!-- UPDATED: direct anchors to matching group IDs -->
      <a href="sections.html#group-Essay" class="group bg-white rounded-2xl p-6 shadow-soft hover:shadow transition flex flex-col">
        <div class="text-xs uppercase tracking-wide text-accent">Essays</div>
        <h3 class="font-serif text-xl mt-2">Ideas &amp; Analysis</h3>
        <p class="text-ink-500 mt-2">Longform reflections on culture, politics, and place.</p>
        <span class="mt-4 text-sm text-ink-300 group-hover:text-accent">Explore →</span>
      </a>
      <a href="sections.html#group-Interview" class="group bg-white rounded-2xl p-6 shadow-soft hover:shadow transition flex flex-col">
        <div class="text-xs uppercase tracking-wide text-accent">Interviews</div>
        <h3 class="font-serif text-xl mt-2">Conversations</h3>
        <p class="text-ink-500 mt-2">Artists, scholars, and organizers in dialogue.</p>
        <span class="mt-4 text-sm text-ink-300 group-hover:text-accent">Explore →</span>
      </a>
      <a href="sections.html#group-Visual" class="group bg-white rounded-2xl p-6 shadow-soft hover:shadow transition flex flex-col">
        <div class="text-xs uppercase tracking-wide text-accent">Visual</div>
        <h3 class="font-serif text-xl mt-2">Photography &amp; Art</h3>
        <p class="text-ink-500 mt-2">Portfolios and visual essays.</p>
        <span class="mt-4 text-sm text-ink-300 group-hover:text-accent">Explore →</span>
      </a>
      <a href="sections.html#group-Review" class="group bg-white rounded-2xl p-6 shadow-soft hover:shadow transition flex flex-col">
        <div class="text-xs uppercase tracking-wide text-accent">Reviews</div>
        <h3 class="font-serif text-xl mt-2">Books &amp; Film</h3>
        <p class="text-ink-500 mt-2">Critical takes and recommendations.</p>
        <span class="mt-4 text-sm text-ink-300 group-hover:text-accent">Explore →</span>
      </a>
    </div>
  </section>

  <!-- Back to top -->
  <button id="backTop"
          class="fixed right-4 bottom-4 hidden px-3 py-2 rounded-full border border-black/10 bg-white shadow-soft text-sm"
          aria-label="Back to top">↑ Top</button>

  <!-- Footer -->
  <footer class="mt-16 bg-white border-t border-black/10 text-sm text-ink-500">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-10 grid sm:grid-cols-2 md:grid-cols-4 gap-10">
      <!-- Brand -->
      <div>
        <div class="-ml-1.5">
          <div class="flex items-center gap-1">
            <img src="assets/logo.png" alt="Camila Tiburcio Rubio Logo" class="h-8 w-8 object-contain" />
            <span class="font-semibold text-ink-900">Camila Tiburcio Rubio</span>
          </div>
        </div>
        <p class="mt-2 text-ink-400 text-sm max-w-xs">
          Essays, interviews, and conversations from the life and mind of Camila Tiburcio Rubio.
        </p>
      </div>
      <!-- Explore -->
      <div>
        <h3 class="font-semibold text-ink-900 mb-3">Explore</h3>
        <ul class="space-y-2">
          <li><a href="features.html" class="u-underline">Features</a></li>
          <li><a href="latest.html" class="u-underline">Latest</a></li>
          <li><a href="sections.html" class="u-underline">Sections</a></li>
          <li><a href="archive.html" class="u-underline">Archive</a></li>
          <li><a href="search.html" class="u-underline">Search</a></li>
        </ul>
      </div>
      <!-- About -->
      <div>
        <h3 class="font-semibold text-ink-900 mb-3">About</h3>
        <ul class="space-y-2">
          <li><a href="about2.html" class="u-underline">About</a></li>
          <li><a href="contact.html" class="u-underline">Contact</a></li>
          <li><a href="mission.html" class="u-underline">Mission</a></li>
          <li><a href="resume.html" class="u-underline">Résumé</a></li>
          <li><a href="newsletter.html" class="u-underline">Newsletter</a></li>
        </ul>
      </div>
      <!-- Follow -->
      <div>
        <h3 class="font-semibold text-ink-900 mb-3">Follow</h3>
        <ul class="space-y-2">
          <li><a href="https://instagram.com" class="u-underline">Instagram</a></li>
          <li><a href="https://twitter.com" class="u-underline">X / Twitter</a></li>
          <li><a href="https://facebook.com" class="u-underline">Facebook</a></li>
          <li><a href="https://linkedin.com" class="u-underline">Linkedin</a></li>
          <li><a href="https://youtube.com" class="u-underline">YouTube</a></li>
        </ul>
      </div>
    </div>
    <div class="text-center text-xs text-ink-300 border-t border-black/10 py-6">
      © <span id="year"></span> Camila Tiburcio Rubio. All rights reserved.
    </div>
  </footer>

  <!-- ====== Posts loader + full-card click behavior ====== -->
  <script type="module">
    /* ---------- Subpath helper (GitHub Pages safe) ---------- */
    const basePath = location.pathname.replace(/[^/]*$/, ''); // e.g. "/CamilaTiburcioRubio/"
    const toBase = (u) => {
      if (!u) return '';
      if (/^https?:\/\//i.test(u)) return u;
      if (u.startsWith('./') || u.startsWith('../')) return new URL(u, location.origin + basePath).pathname;
      if (u.startsWith('/')) return basePath + u.slice(1);
      return basePath + u;
    };

    // Back to top visibility + behavior
    const backTop = document.getElementById('backTop');
    const toggleTop = () => {
      if (window.scrollY > 600) backTop.classList.remove('hidden');
      else backTop.classList.add('hidden');
    };
    window.addEventListener('scroll', toggleTop, { passive:true });
    backTop.addEventListener('click', () => window.scrollTo({ top:0, behavior:'smooth' }));

    /* ---------- Load posts.json (no other deps) ---------- */
    async function loadPosts() {
      const url = toBase('posts.json');
      const res = await fetch(url, { cache: 'no-store' });
      if (!res.ok) throw new Error(`Failed to load ${url} (${res.status})`);
      const arr = await res.json();
      return arr.map(normalize).sort(byNewest);
    }

    /* ---------- Normalize to homepage fields (now includes tags) ---------- */
    function normalize(item){
      const href  = item.url || (item.slug ? `${item.slug}.html` : '#');
      const cover = item.cover || '';
      const tags  = Array.isArray(item.tags)
        ? item.tags
        : (typeof item.tags === 'string'
            ? item.tags.split(',').map(s=>s.trim()).filter(Boolean)
            : []);
      return {
        title: item.title || '',
        href: toBase(href),
        section: item.section || 'Article',
        description: item.excerpt || item.description || '',
        date: item.date || '',
        readMinutes: item.readMinutes || '',
        featured: !!item.featured,
        cover: cover ? toBase(cover) : '',
        tags,
      };
    }
    const byNewest = (a,b)=> new Date(b.date) - new Date(a.date);
    const fmtDate = iso => { try { return new Date(iso).toLocaleDateString(undefined,{year:'numeric',month:'short',day:'numeric'});} catch { return ''; } };
    const $ = s => document.querySelector(s);

    /* ---------- Tag chips (accent scheme like search.html) ---------- */
    const tagsHTML = (tags=[]) =>
      tags.length
        ? `<div class="mt-3 flex flex-wrap gap-2">
             ${tags.map(t => `
               <span class="inline-flex items-center gap-1 px-2.5 py-1 rounded-full bg-accent/10 text-accent border border-accent/20 text-xs font-semibold">${t}</span>
             `).join('')}
           </div>`
        : '';

    /* ---------- Templates (cards + rows) ---------- */
    const cardHTML = p => `
      <article class="bg-white rounded-2xl shadow-soft overflow-hidden flex flex-col cursor-pointer" data-href="${p.href}">
        ${p.cover ? `<img class="aspect-[16/10] object-cover" src="${p.cover}" alt="${p.title}">` : ''}
        <div class="p-6 flex-1 flex flex-col">
          <div class="text-xs uppercase tracking-wide text-accent">${p.section}</div>
          <h3 class="font-serif text-xl mt-2 leading-snug"><a class="u-underline" href="${p.href}">${p.title}</a></h3>
          ${p.description ? `<p class="text-ink-500 mt-2">${p.description}</p>` : ''}
          ${tagsHTML(p.tags)}
          <div class="mt-auto pt-4 text-sm text-ink-300">${fmtDate(p.date)}${p.readMinutes?` • ${p.readMinutes} min`:''}</div>
        </div>
      </article>`;

    const pickItemHTML = p => `
      <li class="flex gap-4 cursor-pointer" data-href="${p.href}">
        ${p.cover ? `<img class="w-28 h-24 rounded-xl object-cover" src="${p.cover}" alt="${p.title}">` : `<div class="w-28 h-24 rounded-xl bg-ink-900/5"></div>`}
        <div>
          <a class="font-medium u-underline" href="${p.href}">${p.title}</a>
          <p class="text-sm text-ink-500 mt-1">${p.section}${p.readMinutes?` • ${p.readMinutes} min`:''}</p>
        </div>
      </li>`;

    function latestRowHTML(p){
      return `
        <article class="p-6 sm:p-8 flex flex-col sm:flex-row gap-6 cursor-pointer" data-href="${p.href}">
          ${p.cover ? `<img class="w-full sm:w-60 h-40 object-cover rounded-xl" src="${p.cover}" alt="${p.title}">` : ''}
          <div class="flex-1">
            <a class="text-xs uppercase tracking-wide text-accent" href="#">${p.section}</a>
            <h3 class="font-serif text-2xl leading-tight mt-1"><a class="u-underline" href="${p.href}">${p.title}</a></h3>
            ${p.description ? `<p class="text-ink-500 mt-2">${p.description}</p>` : ''}
            ${tagsHTML(p.tags)}
            <div class="mt-4 text-sm text-ink-300">${fmtDate(p.date)}${p.readMinutes?` • ${p.readMinutes} min`:''}</div>
          </div>
        </article>`;
    }

    /* ---------- Make any [data-href] clickable ---------- */
    function enableCardClicks(root=document){
      root.querySelectorAll('[data-href]').forEach(el => {
        if (el.__clickBound) return;
        el.__clickBound = true;
        el.classList.add('cursor-pointer');
        el.setAttribute('role','link');
        el.setAttribute('tabindex','0');
        el.addEventListener('click', e => {
          if (e.target.closest && e.target.closest('a')) return;
          const url = el.getAttribute('data-href');
          if (url) window.location.href = url;
        });
        el.addEventListener('keydown', e => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            const url = el.getAttribute('data-href');
            if (url) window.location.href = url;
          }
        });
      });
    }

    /* ---------- Lead setter ---------- */
    function setLead(p){
      if (!p) return;
      $('#leadImg').src = p.cover || 'https://picsum.photos/1200/675';
      $('#leadImg').alt = p.title || 'Lead story image';
      $('#leadBadge').textContent = p.section || 'Feature';
      $('#leadDate').dateTime = p.date || '';
      $('#leadDate').textContent = fmtDate(p.date);
      $('#leadTitle').innerHTML = `<a class="u-underline" href="${p.href}">${p.title}</a>`;
      $('#leadExcerpt').textContent = p.description || '';
      $('#leadAuthor').textContent = 'Camila Tiburcio Rubio';
      $('#leadRead').textContent = p.readMinutes ? `${p.readMinutes} min` : '';
      $('#leadLink').href = p.href;

      const leadCard = document.getElementById('lead');
      leadCard?.setAttribute('data-href', p.href);
      leadCard?.classList.add('cursor-pointer');
    }

    /* ---------- Render ---------- */
    try {
      const posts = await loadPosts();

      if (!posts.length){
        document.getElementById('featuresGrid').innerHTML = `<div class="text-ink-300 p-6 bg-white rounded-2xl">No featured posts yet.</div>`;
        document.getElementById('latestList').innerHTML   = `<div class="p-8 text-ink-300">No recent posts yet.</div>`;
      } else {
        const featured = posts.filter(p => p.featured);
        const leadPost = featured[0] || posts[0];
        setLead(leadPost);

        // Editors’ picks (up to 3; fill newest)
        const picks = featured.filter(p => p !== leadPost).slice(0,3);
        for (const p of posts){
          if (picks.length >= 3) break;
          if (p !== leadPost && !picks.includes(p)) picks.push(p);
        }
        document.getElementById('picks').innerHTML = picks.map(pickItemHTML).join('') || `<li class="text-ink-300">No picks yet.</li>`;

        // Featured grid (3)
        const grid = featured.filter(p => p !== leadPost).slice(0,3);
        for (const p of posts){
          if (grid.length >= 3) break;
          if (p !== leadPost && !grid.includes(p) && !picks.includes(p)) grid.push(p);
        }
        document.getElementById('featuresGrid').innerHTML = grid.map(cardHTML).join('') ||
          `<div class="text-ink-300 p-6 bg-white rounded-2xl">No featured posts yet.</div>`;

        // Latest (3 newest excluding lead)
        const latest = posts.filter(p => p !== leadPost).slice(0,3);
        document.getElementById('latestList').innerHTML = latest.map(latestRowHTML).join('') ||
          `<div class="p-8 text-ink-300">No recent posts yet.</div>`;
      }

      // Enable stretched-click behavior after DOM injection
      enableCardClicks(document);
    } catch (err) {
      console.error('Homepage failed to render posts:', err);
      document.getElementById('featuresGrid').innerHTML = `<div class="text-ink-300 p-6 bg-white rounded-2xl">Couldn’t load posts.</div>`;
      document.getElementById('latestList').innerHTML   = `<div class="p-8 text-ink-300">Couldn’t load posts.</div>`;
    }

    /* ---------- Header search behavior ---------- */
    function goSearch(q){
      const term = (q || '').trim();
      const url = term ? `search?q=${encodeURIComponent(term)}` : `search`;
      window.location.href = url;
    }
    const qHeader = document.getElementById('qHeader');
    const qHeaderBtn = document.getElementById('qHeaderBtn');
    qHeader?.addEventListener('keydown', e => {
      if (e.key === 'Enter') { e.preventDefault(); goSearch(qHeader.value); }
    });
    qHeaderBtn?.addEventListener('click', e => {
      e.preventDefault(); goSearch(qHeader.value);
    });

    const qHeaderMobile = document.getElementById('qHeaderMobile');
    const qHeaderMobileBtn = document.getElementById('qHeaderMobileBtn');
    qHeaderMobile?.addEventListener('keydown', e => {
      if (e.key === 'Enter') { e.preventDefault(); goSearch(qHeaderMobile.value); }
    });
    qHeaderMobileBtn?.addEventListener('click', e => {
      e.preventDefault(); goSearch(qHeaderMobile.value);
    });

    // Footer year
    const yearEl = document.getElementById('year');
    if (yearEl) yearEl.textContent = new Date().getFullYear();

    // Mobile menu toggle (preserve your existing behavior)
    const menuToggle = document.getElementById('menuToggle');
    const mobileMenu = document.getElementById('mobileMenu');
    menuToggle?.addEventListener('click', () => {
      const open = mobileMenu.classList.toggle('hidden');
      menuToggle.setAttribute('aria-expanded', String(!open));
    });
  </script>
</body>
</html>
